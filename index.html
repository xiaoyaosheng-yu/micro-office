<html>

	<head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8">
	</head>
	<body>
		<div class="table">
			<table border="1">
        <tr>
          <th colspan="2">Company in USA</th>
        </tr>
        <tr>
          <td>Apple, Inc.</td>
          <td>1 Infinite Loop Cupertino, CA 95014</td>
        </tr>
        <tr>
          <td>Google, Inc.</td>
          <td>1600 Amphitheatre Parkway Mountain View, CA 94043</td>
        </tr>
      </table>
		</div>
    <input type="button" id="excel" value="导出" />
    <input type="file" name="" id="file">
  </body>
  <script src="./dist/js/micro-office.js"></script>
  <script>
    var el = document.getElementsByTagName('table')[0];
    var microOffice= new MicroOffice();
    document.getElementById('excel').onclick = function () {
      microOffice.export({
				el,
				filename: '测试'
			});
    }
    const input = document.querySelector('input[type=file]');
    input.addEventListener('change', (el)=>{
      const file = el.target.files[0];
      // const reader = new FileReader()
      // // reader.readAsDataURL(file);
      // reader.readAsArrayBuffer(file);
      // reader.onload = function(e) {
      //   var data = e.target.result;
      //   console.log(data);
      // } 
      microOffice.read(file);
    })
    // input.addEventListener('change', (el)=>{
    //   const reader = new FileReader()
    //   reader.readAsDataURL(el.target.files[0]) // input.files[0]为第一个文件
    //   reader.onload = (readRes)=>{
    //     console.log(readRes);
    //     // document.body.innerHTML += reader.result  // reader.result为获取结果
    //   }
    // }, false)
  
  </script>
  <!-- <script src="./lib/index.js"></script> -->
</html>